# Audio Creatures
In this assignment you'll be using one of the old examples we used in class and use the audio output to encode the motion of the particles as demonstrated in video _XXXXXXXXXX_.

## Step by step
* Take the code provided and move it in _myApps_ folder inside the _apps_ folder of your openFrameworks directory. Run it to make sure it compiles and runs.
* In the _ofApp.h_ file create a variable called `bufferSize` and `sampleRate` both of type int. Also create two variables of type `double` called `globFreq` and `globVol`. These last two variables are the link between the visuals and the audio. The `audioOut()` function is going to store data in there and the `draw()` function is going to read them so that the audio can affect the visuals. Finally, create four `maxiOsc` variables called `osc1`, `osc2`, `osc3` and `osc4`. These are the oscilators that we are going to use to generate sounds.
* Open the _ofApp.cpp_ file and in the `setup()` function initialize the `bufferSize` to 512, the `sampleRate` to 48000. Also, copy/paste the following two lines to properly initialize Maximilian as well as the sound setting for openFrameworks.
  ```
  ofxMaxiSettings::setup(sampleRate, 2, bufferSize);
  ofSoundStreamSetup(2,2,this, sampleRate, bufferSize, 4);
  ```
* If you run the program right now you should have the familiar little creatures move around the screen. The elements that affect the movement is the `stepSize` which encodes how far can each creature move and the `speed` which encodes how fast the creatures can move. At the moment `stepSize` is linked to `mouseX` and `speed` to `mouseY`. We'll link `stepSize` to the volume of the sinewave and `speed` to the modulating frequency. Let's produce the sound first!
* Go to the `audioOut()` function in the line that says `double wave = 0;` replace the 0 with code that will do frequency modulation. Remember that we have three important numbers in frequency modulation. The carrier signal, the modulation frequency and the modulation index. See the class notes and the code examples on what each means. For starters put code that will generate a sinewave of frequency 440 (use `osc1` for this). That will be our carrier signal. Amend your line of code to include a modulating frequency of 1 (use `osc2` for this) and set the modulation index to 100. This will modulate between 340Hz and 440Hz every second. Above the `double wave=...` code add a local variable of type `double` called `modFreq`. We're going to setup our modulation frequency here and replace 1 in the equation below so that the modulation frequency is dynamic. Set the `modFreq` to a sinewave with frequency 0.2 and multiply the outcome by 10. This means that the modulation frequency will oscillate from -10 to 10 every 5 seconds (0.2 times a second). (_Note:_ a sinewave of -10Hz is the same as a sinewave of 10Hz). What you should be hearing now is a modulating wave where the modulation is speading up and slowing down again. Just under the `double wave=...` line, add a `double` called `modAmp`. This will be used to do the amplitude modulation. Using `osc4` link it to a sinewave of frequency 0.05. It means it's going to oscillate between -1 and 1 every 20 seconds. Under this line, make the `wave` equal itself times the `modAmp`. This basically multiplies the sound we were generating in the previous step with the modulation frequency which in effect turns the amplitude (volume) up and down. We are now done with sound. Let's link the graphics together with the audio.
* Just above the _for loop_ of the `audioOut()` function create two variables of type `double`. One called `sumVol` and one called `sumFreq`. Inside the _for loop_ add the absolute value of the `wave` using `fabs()` to the `sumVol` and add the absolute value of `modFreq` to the `sumFreq`. Just under the _for loop_ make the variable `globVol` equal to `sumVol` divided by `bufferSize`. Make `globFreq` equal to `sumFreq` divided by `bufferSize`. This will effectively store the average volume in `globVol` and average modulation frequency in `globFreq` per frame (buffer) of audio. If you're confused in how to do this step have a look at the example _audioWithVisuals_. For this assignment we're going to be using the average rather then the square root, but the rest is more or less the same. Now we're going to use these to drive the graphics.
* Inside the draw function, modify the line that calculates the `stepSize`. Keep the `ofMap()` function but replace the `mouseX` with `globVol` which ranges from 0 to 1, so make sure your unit's domain is changed. Keep the last two parameters of `ofMap()` the same (0,90). Modify the line that calculates the `speed` to use the `globFreq` which ranges from 0 to 10. Keep the last two parameters of `ofMap()` the same (0,0.04).
* Use the lerp function [see documentation](http://www.openframeworks.cc/documentation/types/ofColor.html#show_lerp) to move from red to blue using `globVol`.

